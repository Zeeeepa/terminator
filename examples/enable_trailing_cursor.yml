---
# Enable Trailing Cursor (Mouse Pointer Trails) in Windows Settings
# This workflow automates the process of enabling mouse pointer trails in Windows Accessibility settings

tool_name: execute_sequence
arguments:
  steps:
    # Step 1: Open Windows Settings
    - tool_name: open_application
      arguments:
        app_name: Settings
      delay: "2s"  # Wait for Settings to fully load

    # Step 2: Navigate to Accessibility section
    - tool_name: click_element
      arguments:
        selector: "role:ListItem|name:Accessibility"
        include_tree: false
      delay: "1500ms"  # Wait for page to load

    # Step 3: Navigate to Mouse pointer and touch settings
    - tool_name: click_element
      arguments:
        selector: "role:ListItem|name:Mouse pointer and touch"
        include_tree: false
      delay: "1500ms"  # Wait for settings page to load

    # Step 4: Check current toggle state of Mouse pointer trails
    - tool_name: is_toggled
      arguments:
        selector: "role:Button|name:Mouse pointer trails"
        include_tree: false
      continue_on_error: true
      id: check_trails_state

    # Step 5: Enable Mouse pointer trails only if currently disabled
    # The is_toggled tool returns true if ON, false if OFF
    - tool_name: set_toggled
      arguments:
        selector: "role:Button|name:Mouse pointer trails"
        state: true  # Set to enabled (true = ON)
        include_tree: false
      delay: "500ms"

    # Step 6: Optional - Adjust trail length using the slider
    # Uncomment the following step if you want to set a specific trail length
    # - tool_name: set_range_value
    #   arguments:
    #     selector: "role:Slider|name:Mouse pointer trails length"
    #     value: 10  # Set trail length (1-20 range typically)
    #   continue_on_error: true

    # Step 7: Optional - Show confirmation
    - tool_name: highlight_element
      arguments:
        selector: "role:Button|name:Mouse pointer trails"
        color: 65280  # Green color
        duration_ms: 2000
        text: "Enabled!"
        include_element_info: false
      continue_on_error: true

  # Workflow configuration
  stop_on_error: false  # Continue even if some steps fail
  verbosity: normal  # Set to 'verbose' for detailed output

# Workflow metadata
variables:
  trail_length:
    type: number
    label: "Trail Length"
    description: "Length of the mouse pointer trail (1-20)"
    default: 7
    required: false

  highlight_result:
    type: boolean
    label: "Highlight Result"
    description: "Show visual confirmation when enabled"
    default: true
    required: false

# Alternative selectors for better compatibility across Windows versions
selectors:
  accessibility_item: "role:ListItem|name:Accessibility"
  mouse_settings: "role:ListItem|name:Mouse pointer and touch"
  trails_toggle: "role:Button|name:Mouse pointer trails"
  trails_slider: "role:Slider|name:Mouse pointer trails length"
  settings_search: "role:Edit|name:Find a setting"

# Usage notes:
# 1. This workflow requires Windows Settings app to be available
# 2. The user must have appropriate permissions to modify accessibility settings
# 3. The workflow will work on Windows 10/11 with standard Settings app
# 4. Trail length adjustment is optional and can be customized via variables
# 5. Visual highlighting at the end confirms successful enablement