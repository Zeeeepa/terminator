# @workflow-info
# name: Form Analysis Simple
# description: Simple form analysis
# version: 1.0.0

steps:
  - name: Analyze form state
    tool_name: execute_browser_script
    id: analyze_form_state
    arguments:
      selector: "role:Window|name:SAP BusinessOne - Google Chrome"
      script: |
        const analysis = {};
        const domainUser = document.querySelector('input[name="domain_user"]');
        const domainPassword = document.querySelector('input[name="domain_password"]');
        const logonBtn = document.querySelector('input[name="logon_sbo_btn"]');
        const form = document.querySelector('form');

        if (domainUser) {
          analysis.domainUser = {
            value: domainUser.value,
            disabled: domainUser.disabled,
            required: domainUser.required,
            valid: domainUser.validity.valid
          };
        }

        if (domainPassword) {
          analysis.domainPassword = {
            hasValue: !!domainPassword.value,
            disabled: domainPassword.disabled,
            required: domainPassword.required,
            valid: domainPassword.validity.valid
          };
        }

        if (logonBtn) {
          analysis.logonBtn = {
            disabled: logonBtn.disabled,
            onclick: logonBtn.onclick ? 'has onclick' : 'no onclick'
          };
        }

        if (form) {
          analysis.form = {
            action: form.action,
            method: form.method,
            valid: form.checkValidity()
          };
        }

        return JSON.stringify(analysis, null, 2);